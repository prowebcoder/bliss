{% assign customertype = '' %}

{% if customer %}
  {% for tag in customer.tags %}
    {% if tag == 'Retail' %}
      {% assign customertype = 'retail' %}
    {% endif %}
    {% if tag == 'Practitioner' %}
      {% assign customertype = 'wholesale' %}
    {% endif %}
  {% endfor %}
{% endif %}

{% if customertype == 'wholesale' %}
  <div class="page-width section">
    {% if section.settings.section_heading != blank %}
      <h2 class="section-title">{{ section.settings.section_heading }}</h2>
    {% endif %}

    {% assign collections_array = 
      section.settings.collection_1 | append: ',' |
      append: section.settings.collection_2 | append: ',' |
      append: section.settings.collection_3 | append: ',' |
      append: section.settings.collection_4 | split: ',' %}

    {% for collection_handle in collections_array %}
      {% assign collection = collections[collection_handle] %}
      {% if collection %}
        <div class="collection-block" style="margin-bottom: 40px;">
          <h3><a href="{{ collection.url }}">{{ collection.title }}</a></h3>

          <div class="grid grid--uniform">
            {% for product in collection.products limit: section.settings.products_per_collection %}
              {% render 'product-card', product: product %}
            {% endfor %}
          </div>
        </div>
      {% endif %}
    {% endfor %}
  </div>
{% endif %}

{% schema %}
{
  "name": "Wholesale Collections",
  "settings": [
    {
      "type": "text",
      "id": "section_heading",
      "label": "Section Heading",
      "default": "Wholesale Collections"
    },
    {
      "type": "collection",
      "id": "collection_1",
      "label": "Collection 1"
    },
    {
      "type": "collection",
      "id": "collection_2",
      "label": "Collection 2"
    },
    {
      "type": "collection",
      "id": "collection_3",
      "label": "Collection 3"
    },
    {
      "type": "collection",
      "id": "collection_4",
      "label": "Collection 4"
    },
    {
      "type": "range",
      "id": "products_per_collection",
      "label": "Number of Products per Collection",
      "min": 1,
      "max": 12,
      "step": 1,
      "default": 4
    }
  ],
  "presets": [
    {
      "name": "Wholesale Collections",
      "category": "Custom"
    }
  ]
}
{% endschema %}
